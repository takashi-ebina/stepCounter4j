# 画面設計書　ホーム画面
## 画面概要
ステップ数のカウント処理を実施するホーム画面です

## 画面レイアウト
### ホーム画面
![ホーム画面](img/ホーム画面/ホーム画面レイアウト.png)

## 画面項目
|NO|項目名称|取得元|種別|繰り返し|型|表示形式|桁最小|桁最大|必須項目|ソート|初期値|備考|
|:----|:----|:----|:----|:----|:----|:----|:----|:----|:----|:----|:----|:----|
|1|ヘッダーロゴ|-|画像（IMG)|-|-|-|-|-|-|-|-| |
|2|入力フォルダ|-|テキストボックス（TB)|-|文字（全てOK）|-|-|200|○|-|ステップカウンターを起動しているディレクトリのパス|プレースホルダテキスト：入力フォルダ|
|3|入力フォルダ選択ボタン|-|ボタン（BT)|-|-|-|-|-|-|-|-| |
|4|出力フォルダ|-|テキストボックス（TB)|-|文字（全てOK）|-|-|255|○|-|ステップカウンターを起動しているディレクトリのパス|プレースホルダテキスト：出力ファイル<br>ツールチップ：拡張子はCSVを指定してください|
|5|出力フォルダ選択ボタン|-|ボタン（BT)|-|-|-|-|-|-|-|-| |
|6|ソート区分_無|-|ラジオボックス（RB）|-|-|-|-|-|-|○|-| |
|7|ソート区分_昇順|-|ラジオボックス（RB）|-|-|-|-|-|-|○|-| |
|8|ソート区分_降順|-|ラジオボックス（RB）|-|-|-|-|-|-|○|-| |
|9|ソート対象_ファイルパス|-|ラジオボックス（RB）|-|-|-|-|-|-|○|-| |
|10|ソート対象_総行数|-|ラジオボックス（RB）|-|-|-|-|-|-|○|-| |
|11|ソート対象_実行行数|-|ラジオボックス（RB）|-|-|-|-|-|-|○|-| |
|10|ソート対象_コメント行数|-|ラジオボックス（RB）|-|-|-|-|-|-|○|-| |
|11|ソート対象_空行数|-|ラジオボックス（RB）|-|-|-|-|-|-|○|-| |
|12|カウント開始ボタン|-|ボタン（BT)|-|-|-|-|-|-|-|-| |

## 画面項目（表示制御）
### パターン１　初期表示
|項目名称／表示制御|ヘッダーロゴ|入力フォルダ|入力フォルダ選択ボタン|出力フォルダ|出力フォルダ選択ボタン|ソート区分|ソート対象|カウント開始ボタン|
|:----|:----|:----|:----|:----|:----|:----|:----|:----|
|表示／非表示|○|○|○|○|○|○|○|○|
|活性／非活性|○|○|○|○|○|○|○|○|

### パターン２　入力フォルダ選択ボタン、出力フォルダ選択ボタン、カウント開始ボタン押下
|項目名称／表示制御|ヘッダーロゴ|入力フォルダ|入力フォルダ選択ボタン|出力フォルダ|出力フォルダ選択ボタン|ソート区分|ソート対象|カウント開始ボタン|
|:----|:----|:----|:----|:----|:----|:----|:----|:----|
|表示／非表示|○|○|○|○|○|○|○|○|
|活性／非活性|○|○|×|○|×|○|○|×|

## 画面イベント
|NO|項目名称|イベント|処理概要|処理詳細|
|:----|:----|:----|:----|:----|
|1|入力フォルダ選択ボタン|クリック|ディレクトリ選択ダイアログを表示する| |
|2|出力ファイル選択ボタン|クリック|ファイル選択ダイアログを表示する| |
|3|カウント開始ボタン|クリック|ステップ数集計処理を実施し、ポップアップで以下のメッセージを表示する<br><br>ステップ数を集計したCSVファイルの作成が成功した場合：<br>「ステップカウント処理が完了しました。 処理結果：正常終了」<br>上記以外の場合：<br>「ステップカウント処理が完了しました。 処理結果：異常終了」|「処理詳細 ステップカウント処理」参照|

## 入力値チェック
|NO|画面イベントNO|チェック種別|チェック対象項目|チェック条件|メッセージ|備考|
|:----|:----|:----|:----|:----|:----|:----|
|1|3|単項目チェック|入力フォルダ|必須チェック|入力フォルダ　未入力です。| |
|2|3|単項目チェック|入力フォルダ|最大文字数チェック|入力フォルダ　200文字を超えています。| |
|3|3|単項目チェック|入力フォルダ|ファイルチェック<br>入力値のファイルパスがファイルの場合はエラーとする|入力フォルダ　ファイルパスを指定しています。| |
|4|3|単項目チェック|出力ファイル|必須チェック|出力ファイル　未入力です。| |
|5|3|単項目チェック|出力ファイル|最大文字数チェック|出力ファイル　255文字を超えています。| |
|6|3|単項目チェック|出力ファイル|フォルダチェック<br>入力値のファイルパスがフォルダの場合はエラーとする|出力ファイル　フォルダパスを指定しています。| |
|7|3|単項目チェック|出力ファイル|拡張子（CSV）チェック<br>入力値のファイルの拡張子が「.csv」以外の場合はエラーとする|出力ファイル　拡張子がcsvではありません。| |

## 処理詳細
### ステップ数のカウント処理
1. **入力値チェック**
    -  入力値チェックエラーの場合はポップアップでメッセージを表示し、処理を終了する
    -  入力値チェックの仕様は「入力値チェック」を参照
2. **ステップ数のカウント処理**
    - 入力フォルダに対して再帰処理を行い、１ファイル毎にステップ数のカウント処理を行う
    1. **ステップカウント処理対象の拡張子判定**
        - 拡張子がjava、cs、sqlの場合：「2-2.ステップカウント対象ファイルのステップ数のカウント処理」を行う
        - 上記以外の場合：次のファイルに対して「1. ステップカウント処理対象の拡張子判定」を行う
    2. **ステップカウント対象ファイルのステップ数のカウント処理**
        - ステップカウント対象ファイルに対して、ステップ数のカウント処理を行う
        - 総行数、実行行数、コメント行数、空行数をカウント対象とし、各項目のカウントの仕様は以下とする
        - 【前提条件】
            - 構文に問題のないプログラムファイルであること
                - 本ツールでは構文解析は行わないため、構文エラーが発生しているプログラムファイルのカウント結果について保証しない 
        - 【仕様】
            - ファイル読み込み時の文字コード：Java仮想マシンのデフォルトの文字セットに依存する
            - ファイル内の改行コード：CR/LF/CRLFを改行コードとして扱う
            - ファイルを１行ずつ読み込み、１行毎に行の先頭と末尾の半角スペースを削除した上で、以下の条件で判定を行う
                - 総行数：読み込んだ行数を総行数として計上する
                - 実行行数：空行及びコメント行でない行を実行行数として計上する
                - コメント行数：以下の場合、コメント行数として計上する
                    - 行頭に１行コメントが存在する場合
                    - 行頭に複数行コメント（開始）かつ、行末に複数行コメント（終了）が存在する場合
                    - コメント行状態の場合　※コメント行状態となる条件は以下
                        - 行頭に複数行コメント（開始）が存在し、行末に複数行コメント（終了）が存在しない場合
                            - コメント行状態の行において、行末に複数行コメント（終了）が存在する場合、コメント行状態を解除する
                - 空行数：空文字の行を空行数として計上する
        - 【例外処理】
            - ファイル読み込みに失敗したファイルは総行数、実行行数、コメント行数、空行数を全て０行として扱い、処理を継続する
3. **CSVファイルの出力処理**
    - 「2.ステップ数のカウント処理」の結果をもとに、CSVファイルの出力処理を行う
    - CSVファイルの出力内容は「CSVファイルレイアウト定義」を参照

## CSVファイルレイアウト定義
### 基本情報
|ファイル名称|区切り文字|文字コード|改行コード|ファイル命名規則|
|:----|:----|:----|:----|:----|
|プログラムファイルステップ数集計結果|カンマ（,）|UTF-8|UNIXの場合："\n"、<br>Microsoft Windowsの場合："\r\n"|出力ファイルの入力内容に準ずる|

### 項目説明
|NO|項目名|必須|桁数|フォーマット|I/O|内容|
|:----|:----|:----|:----|:----|:----|:----|
|1|ファイルパス|必須|-| |O|ステップ数カウント対象のファイルパス<br>最終行は「合計」を出力する|
|2|総行数|必須|-| |O|ステップ数カウント対象の総行数|
|3|実行行数|必須|-| |O|ステップ数カウント対象の実行行数|
|4|コメント行数|必須|-| |O|ステップ数カウント対象のコメント行数|
|5|空行数|必須|-| |O|ステップ数カウント対象の空行数|